<?xml version="1.0" encoding="ISO-8859-1"?>

<!DOCTYPE jheat-mapping PUBLIC 
	"-//JHeat/JHeat DTD 1.0//BR" 
	"http://www.infoway-pi.com.br/jheat.dtd">
	<!-- Verificar matricula por contrato -->
<jheat-mapping>
<flow 
	name="consultarGuia" 
	class="br.com.infowaypi.ecare.services.ConsultarGuiaService"
	display-name="Imprimir 2º Via de Guias" section="relatoriosPrestador">
		
	<description>Imprimir 2º Via</description>		
	
	<step-method name="consultarGuia" display-name="Identificar Beneficiário">
		<step-param name="autorizacao" size="12" type="java.lang.String" display-name="Autorização" mask="99999999"/>
		<step-param name="contrato" size="8" type="java.lang.String" display-name="Proposta" mask="000000"/>

		<step-param name="dataInicial" type="java.lang.String" display-name="Data inicial" input-type="date"/>
		<step-param name="dataFinal" type="java.lang.String" display-name="Data final" input-type="date"/>
		<session-param name="prestador" operation="none"/>
		<!--select-param
			name="prestadores"
			display-name="Escolha o Prestador"
			type="br.com.infowaypi.ecarebc.associados.Prestador">
			<autocomplete style-class="autocomplete" minimum-characters="3" force-selection="true">
				<search-property name="pessoaJuridica.fantasia" display-name="Prestador"/>
				<name-property name="pessoaJuridica.fantasia" display-name="Prestador"/>
			</autocomplete>	
		</select-param-->	
		
		<step-return name="resumoGuias" type="br.com.infowaypi.ecare.atendimento.ResumoGuias" 
	         display-name="Resumo de Guias" scope="session"/>
	</step-method>
	
	<step-method name="selecionarGuia" display-name="Escolher Guia">
		<select-param
			name="guias"
			type="br.com.infowaypi.ecarebc.atendimentos.GuiaSimples"
			display-name="Escolher Guia"
			session-property-ref="resumoGuias">
			<radio-group>
				<display-property name="autorizacao" display-name="Autorização"/>
				<display-property name="dataDeAbertura" display-name="Criação" type="date"/>
				<display-property name="dataAtendimento" display-name="Atendimento" type="date"/>				
				<display-property name="segurado.pessoaFisica.nome" display-name="Beneficiário"/>
				<display-property name="prestador.pessoaJuridica.fantasia" display-name="Prestador"/>
				<display-property name="situacao.descricao" display-name="Situação"/>
				<display-property name="situacao.dataSituacao" display-name="Data" type="date"/>				
				<display-property name="descricaoDoTipo" display-name="Tipo"/>
				<display-property name="valorTotal" display-name="Total" type="money"/>				
			</radio-group>
		</select-param>
		<step-return name="guia" type="br.com.infowaypi.ecarebc.atendimentos.GuiaSimples" 
			display-name="" scope="session"/>
	</step-method>
		
	<step-method name="finalizar" display-name="Informações da Guia" title="Informações da Guia" >
		
		<html>
			<![CDATA[ 
				<span class="not-for-print">
					<button type="button" name="imprimir" class="actionButton" onclick="window.print();">Imprimir</button>
				</span>
			]]>
		</html>
			
		<session-param name="guia" display-name="Informações da Guia" style-class="not-for-print">
			<display-property name="autorizacao" display-name="Autorização"/>
				<display-property name="descricaoDoTipo" display-name="Tipo"/>
				<display-property name="dataDeAbertura" display-name="Dt. de Criação" type="date"/>
				<display-property name="dataAtendimento" display-name="Dt. de Atendimento" type="date"/>				
				<display-property name="situacao.motivo" display-name="Situação Atual"/>
				<display-property name="situacao.dataSituacao" display-name="Data da Situação" type="date"/>
				<display-property name="especialidade.descricao" display-name="Especialidade"/>
				<display-property name="valorTotal" display-name="Valor Total" type="money"/>

			<!--html>
				<![CDATA[ <infoway:tableSeparator titulo="Histórico de Situações da Guia" colspan="2"/> ]]>
			</html-->

			<!--collection-display name="situacoes" display-name="Histórico de Situações">
				<display-property name="descricao" display-name="Descrição"/>
				<display-property name="motivo" display-name="Motivo"/>				
				<display-property name="dataSituacao" display-name="Data" type="date"/>
				<display-property name="usuario.nome" display-name="Usuário"/>	
			</collection-display-->
			
			<html>
				<![CDATA[ <infoway:tableSeparator titulo="Informações do Beneficiário" colspan="2"/> ]]>
			</html>

			<display-property name="segurado.tipoDeSegurado" display-name="Tipo"/>				
			<display-property name="segurado.contrato" display-name="Proposta"/>
			<display-property name="segurado.pessoaFisica.nome" display-name="Nome"/>				
			<display-property name="segurado.pessoaFisica.descricaoDoSexo" display-name="Sexo"/>																							
			<display-property name="segurado.pessoaFisica.dataNascimento" display-name="Nascimento" type="date"/>		
			<display-property name="segurado.pessoaFisica.telefoneResidencial" display-name="Telefone"/>
			<display-property name="segurado.pessoaFisica.endereco" display-name="Endereço"/>
			<display-property name="segurado.pessoaFisica.endereco.municipio.descricao" display-name="Município"/>
			
			<html>
				<![CDATA[ <infoway:tableSeparator titulo="Histórico de Situações do Beneficiário" colspan="2"/> ]]>
			</html>
			
			<collection-display name="segurado.situacoes" display-name="Histórico de Situações">
				<display-property name="descricao" display-name="Descrição"/>
				<display-property name="motivo" display-name="Motivo"/>				
				<display-property name="dataSituacao" display-name="Data" type="date"/>
				<display-property name="usuario.nome" display-name="Usuário"/>	
			</collection-display>
			
			<html>
				<![CDATA[ <infoway:tableSeparator titulo="Informações do Prestador" colspan="2"/> ]]>
			</html>

			<display-property name="prestador.pessoaJuridica.fantasia" display-name="Prestador"/>	
			<display-property name="prestador.situacao.descricao" display-name="Sit. do Prestador"/>				
			<display-property name="profissional.pessoaFisica.nome" display-name="Profissional"/>	
			<display-property name="profissional.situacao.descricao" display-name="Sit. do Profissional"/>
			<display-property name="prestador.pessoaJuridica.telefone" display-name="Telefone"/>
			<display-property name="prestador.pessoaJuridica.endereco" display-name="Endereço"/>
			<display-property name="prestador.pessoaJuridica.endereco.municipio" display-name="Município"/>
			
			<html>
				<![CDATA[ <infoway:tableSeparator titulo="Procedimentos Solicitados" colspan="2"/> ]]>
			</html>

			<collection-display name="procedimentos" display-name="Procedimento">
				<display-property name="procedimentoDaTabelaCBHPM.codigo" display-name="Código"/>
				<display-property name="procedimentoDaTabelaCBHPM.descricao" display-name="Descrição"/>				
				<display-property name="bilateral" display-name="Bilateral" type="boolean"/>
				<display-property name="situacao.descricao" display-name="Sit."/>	
				<display-property name="valorTotal" display-name="Valor Bruto" type="money"/>
			</collection-display>
		
			<!--html>
				<![CDATA[ <infoway:tableSeparator titulo="Informações sobre Faturamento" colspan="2"/> ]]>
			</html>

			<display-property name="consignacao.competenciaFormatada" display-name="Consignação"/>
			<display-property name="faturamento.competenciaFormatada" display-name="Faturamento"/-->

			<html>
				<![CDATA[ <infoway:tableSeparator titulo="Autenticação" colspan="2"/> ]]>
			</html>
		
			<display-property name="numeroAutenticacao" display-name="Autenticação"/>
			
		</session-param>
		<html>
			<![CDATA[ <infoway:imprimirGuia titulo="GUIA"/> 
				<span class="not-for-print">
						<button type="button" name="imprimir" class="actionButton" onclick="window.print();">Imprimir</button>
					</span>
			]]>
		</html>
	</step-method>
</flow>	
</jheat-mapping>